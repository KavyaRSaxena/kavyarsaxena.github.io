<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Understanding True Class Probability for Reliable Predictions | Kavya Ranjan Saxena </title> <meta name="author" content="Kavya Ranjan Saxena"> <meta name="description" content="Mathematical formulation and theory of TCP."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="/assets/img/mypic.jpg?6f01e6d86176fd475ea84d838b3781b7"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://kavyarsaxena.github.io/blog/2026/tcp/"> <script src="/assets/js/theme.js?a81d82887dd692e91686b43de4542f18"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightbox2@2.11.5/dist/css/lightbox.min.css" integrity="sha256-uypRbsAiJcFInM/ndyI/JHpzNe6DtUNXaWEUWEPfMGo=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@5.4.4/dist/photoswipe.min.css" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/spotlight.js@0.7.8/dist/css/spotlight.min.css" integrity="sha256-Dsvkx8BU8ntk9Iv+4sCkgHRynYSQQFP6gJfBN5STFLY=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://cdn.jsdelivr.net/npm/venobox@2.1.8/dist/venobox.min.css" integrity="sha256-ohJEB0/WsBOdBD+gQO/MGfyJSbTUI8OOLbQGdkxD6Cg=" crossorigin="anonymous"> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Kavya</span> Ranjan Saxena </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">blog <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">cv </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Understanding True Class Probability for Reliable Predictions</h1> <p class="post-meta"> Created on January 01, 2026 </p> <p class="post-tags"> <a href="/blog/2026"> <i class="fa-solid fa-calendar fa-sm"></i> 2026 </a>   ·   <a href="/blog/tag/confidence-estimation"> <i class="fa-solid fa-hashtag fa-sm"></i> Confidence Estimation</a>   ·   <a href="/blog/category/active-learning"> <i class="fa-solid fa-tag fa-sm"></i> Active Learning</a>   <a href="/blog/category/machine-learning"> <i class="fa-solid fa-tag fa-sm"></i> Machine Learning</a> </p> </header> <article class="post-content"> <div id="markdown-content"> <p>Confidence criteria is essential for identifying ambiguous or hard-to-classify samples within the same domain. Samples with low confidence often lie near decision boundaries, contain noise, or exhibit features that are weakly discriminative. By contrast, high-confidence predictions typically correspond to samples that are well supported by the learned representation. Distinguishing between these cases enables more informed decision-making in downstream tasks such as active learning. Among various confidence measures, the true class probability is one of the most intuitive and widely used. It directly reflects how strongly the model believes in the correct label under its learned probability distribution.</p> <h3 id="1-pre-training">1. <strong>Pre-training</strong> </h3> <p>Before understanding how TCP works, we need to have a pre-trained model. For simplicity, consider an image classification problem where the input is classified into 5 classes.</p> <p>Consider a dataset \(D_1^S = \{(X_i,Y_i)\}_{i=1}^{I}\), where \(X_i\) is an \(N\times N\) image and \(Y_i\in \{0,1\}^C\) is a one-hot vector over \(C=5\) classes. The ground truth class \(y^*_i\) is simply obtained by using argmax over the one-hot vector \(Y_i\). We train the base model \(f_{[\phi,\theta]}\) on \(D_1^S\) dataset. Here, \(\phi\) and \(\theta\) are the randomly initialized parameters of the feature extractor layers and classifier layer, respectively. With \(X_i\) as the input, the base model \(f_{[\phi,\theta]}\) predicts an output distribution \(\hat{Y}_i\) of dimension \(C\) by computing softmax output for each of the \(C\) classes. During training, the base model parameters \(\phi\) and \(\theta\) are updated using the gradient descent algorithm as:</p> \[[\phi,\theta] \leftarrow [\phi,\theta] - \alpha \nabla_{[\phi,\theta]}\mathcal{L}(f_{[\phi,\theta]})\] <p>where \(\alpha \in \mathbb{R}^+\) is the learning rate and loss \(\mathcal{L}\) is defined as the categorical cross entropy loss as</p> \[\mathcal{L} = - \sum_{i,c} Y_{ic} \log(\hat{Y}_{ic})\] <p>The base model \(f_{[\phi,\theta]}\) is trained for \(E\) epochs.</p> <h3 id="2-output-probabilities">2. <strong>Output Probabilities</strong> </h3> <p>With the pre-trained base model \(f_{[\phi,\theta]}\), we now examine different types of output probabilities.</p> <p>Consider a sample \((X_i,Y_i)\in D_1^S\). With \(X_i\) as an input, the pre-trained base model \(f_{[\phi,\theta]}\) predicts an output distribution \(\hat{Y}_i\).</p> <h4 id="21-maximum-class-probability">2.1 Maximum Class Probability</h4> <p>A standard confidence criteria to obtain confidence value is to consider the softmax probability corresponding to the predicted class. This is also termed as Maximum Class Probability (MCP). The MCP value is obtained by</p> \[\underset{c}{max} \, P(\hat{Y}_i = c|[\phi,\theta],X_i) = P(\hat{Y}_i = \hat{y}_i|[\phi,\theta],X_i)\] <p>This is depicted in the following figure.</p> <figure style="text-align:center;"> <img src="/assets/img/blogs/tcp/mcp.png" width="450"> </figure> <p><strong>Drawback:</strong> It leads to high confidence values for both correct and incorrect predictions as shown below. Ideally, the model should give low confidence for incorrect predictions and high confidence for correct predictions.</p> <figure style="text-align:center;"> <img src="/assets/img/blogs/tcp/mcp-correct-incorrect.png" width="950"> </figure> <p><strong>Solution:</strong> True Class Probability is a more suitable confidence criteria</p> <h4 id="22-true-class-probability">2.2 True Class Probability</h4> <p>For a given input \(X_i\), the TCP refers to the probability corresponding to the ground-truth class, i.e.,</p> \[c^*_i = P(\hat{Y}_i=y_i^*|[\phi,\theta],X_i)\] <p>Here, \(c_i^*\) is the ground-truth confidence value for a particular input \(X_i\). This ensures that the model gives low confidence on the incorrectly predicted inputs and high confidence on the correctly predicted inputs. This is depicted from the following figure.</p> <figure style="text-align:center;"> <img src="/assets/img/blogs/tcp/tcp-correct-incorrect.png" width="950"> </figure> <p>This directly quantifies the model confidence in the correct label, making it more informative for tasks such as active learning.</p> <h3 id="3-implementation">3. <strong>Implementation</strong> </h3> <p>As we have seen, the True Class Probability is the predictive probability corresponding to the ground-truth class. But during inference, we do not have access to the ground-truth classes.</p> <p><strong>How to implement then?</strong></p> <p>We build an auxiliary confidence model \(f_{\psi}\) on top of the feature extractor layers \(\phi\) of the pre-trained base model. We use the same \(D_1^S\) to train such a model. With \(X_i\) as the input, the features are extracted from the feature extractor layers are fed to the confidence model that outputs a confidence prediction \(\hat{c}_i = f_{\psi}(X_i)\) which is a scalar value, i.e., \(\hat{c}_i \in [0,1]\). During training, the parameters \(\psi\) are learned such that the predicted confidence values are close to the actual or ground-truth confidence values \(c_i^*\). This is depicted from the following figure.</p> <figure style="text-align:center;"> <img src="/assets/img/blogs/tcp/tcp-model.png" width="450"> </figure> <p>The parameters \(\psi\) are updated using gradient descent algorithm as:</p> \[\psi \leftarrow \psi - \beta \mathcal{L}_{conf}(f_{\psi})\] <p>where \(\beta \in \mathbb{R}^+\) is the learning rate and \(\mathcal{L}_{conf}\) is the mean squared loss defined as:</p> \[\mathcal{L}_{conf} = \frac{1}{I}\sum_{i=1}^{I}(\hat{c}_i - c_i^*)^2\] <h3 id="4-evaluation">4. <strong>Evaluation</strong> </h3> <p>Consider an evaluation dataset \(D_2^S = \{(X_j)\}_{j=1}^J\) from the same domain. With \(X_j\) as the input, the pre-trained base model \(f_{[\phi,\theta]}\) gives the predicted class \(\hat{y}_j\) and the confidence model \(f_{\psi}\) gives the predicted confidence \(\hat{c}_i\in [0,1]\). If the confidence for a particular sample is low, the model flags the prediction as unreliable, indicating that the sample may be ambiguous, noisy, or close to the decision boundary. The predicted confidence values can be used to rank samples:</p> <ul> <li>Low-confidence samples are prioritized for human annotation or further inspection.</li> <li>High-confidence samples can be safely trusted or pseudo-labeled.</li> </ul> <p>This makes TCP particularly effective for active learning, where one selects samples with the lowest confidence for annotation.</p> </div> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Kavya Ranjan Saxena. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?c15de51d4bb57887caa2c21988d97279"></script> <script defer src="/assets/js/copy_code.js?c8a01c11a92744d44b093fc3bda915df" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/lightbox2@2.11.5/dist/js/lightbox.min.js" integrity="sha256-A6jI5V9s1JznkWwsBaRK8kSeXLgIqQfxfnvdDOZEURY=" crossorigin="anonymous"></script> <script defer src="/assets/js/photoswipe-setup.js" type="module"></script> <script defer src="https://cdn.jsdelivr.net/npm/spotlight.js@0.7.8/dist/spotlight.bundle.min.js" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/venobox@2.1.8/dist/venobox.min.js" integrity="sha256-LsGXHsHMMmTcz3KqTaWvLv6ome+7pRiic2LPnzTfiSo=" crossorigin="anonymous"></script> <script defer src="/assets/js/venobox-setup.js?897c1d9c0b6fcf82b949511c1609d055" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>